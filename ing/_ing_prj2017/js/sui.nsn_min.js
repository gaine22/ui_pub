/*
 * Copyright ⓒ LG CNS, Inc. All rights reserved.
 *
 * Do Not Erase This Comment!!!
 *
 * 본 프로그램의 모든 내용은 LG CNS "SmartChannelPlatform" 이하 SCP의 자산이므로
 * 어떤한 경우라도 허락없이 재배포 하거나 LG CNS 외부로의 유출이 금지되어 있습니다.
 *
 * 프로젝트에서 SCP를 사용하거나 SCP를 변경한 경우 프로젝트 정보와 변경된 내용을 SCP 팀에 알려야 한다.
 */

/**
 * ****************************************************************************
 *  @module       : sui
 *  @version      : v1.0
 *  @fileName     : sui.nsn.js
 *  @description  : SmartUI JavaScript Library 
 *  @author       : LG CNS SCP
 *  @dateCreated  : 2011.12.10
 * ----------------------------------------------------------------------------
 *  [ 변경내역 ]
 *  <ul>
 *    <li>2011.12.10 : 최초작성</li>
 *    <li>2012.05.03 : sui.js에 정의된 컴포넌트 빌드 함수를 이관해옴</li>
 *    <li>2012.11.28 : 배포버전 최초 작성</li>
 *    <li>2013.10.14 : callScreen callback 함수 수정</li>
 *    <li>2013.10.29 : callScreen network error callback 함수 추가</li>
 *  </ul>
 **/
(function(){var a=function(){var g=sui.env,d=sui.res,f=sui.ucb,e=sui.log;var b={},c={};b.nScreenDraw=(function(){var h={},i={};h.getChildAreaHtml=function(j){};h.getAreaHtml=function(k,j){};h.getListCssPath=function(r,n,m,p){var s=[];if(0==p.get("nscreenArea").get("totalRowSize")){return s}if(""!==p.get("templateStyle")){s.push({id:r+"_css_temp",url:p.get("templateStyle")})}for(var q=0,j=p.get("nscreenArea"),l=undefined,o=undefined,k=j.get("totalRowSize");q<k;q+=1){l=j.get("rows");o=l.get("areaTargetStyle").get(q)||"none";if("none"!==o){s.push({id:r+"_css_"+q,url:o})}}return s};h.getListScriptPath=function(m,j){var l=[];if(0==j.get("nscreenArea").get("totalRowSize")){return l}var k=j.get("scriptFile")||"none";if("none"!==k){l.push({id:m+"_Script",url:k})}return l};i.draw=function(n,j,m,k,l){if(0==k.get("nscreenArea").get("totalRowSize")){return false}(function(o){d.includeCss(null,o)}(h.getListCssPath(n,j,m,k)));sui.res.loadScreen(g.get("nsn.containerId"),k.get("templateFile"),null,null,function(){for(var q=0,o=k.get("nscreenArea"),s=o.get("totalRowSize"),r=undefined,p=undefined;q<s;q++){r=o.get("rows");p=$("#"+r.get("areaId").get(q));if(p[0]){switch(r.get("areaTargetType").get(q)){case"01":sui.res.loadScreen(p,r.get("areaTargetResource").get(q),null,null,(function(t){if(0===((s-1)-t)){(function(u){setTimeout(function(){if(typeof l=="function"){l(k.get("prcSts"),k.get("resCode"))}d.includeJs(null,u)},500)}(h.getListScriptPath(n,k)))}})(q));break;case"02":p.html(r.get("areaTargetResource").get(q));if(0===((s-1)-q)){(function(t){setTimeout(function(){if(typeof l=="function"){l(k.get("prcSts"),k.get("resCode"))}d.includeJs(null,t)},500)}(h.getListScriptPath(n,k)))}break;case"03":break;default:break}}else{throw {at:"sui.nsn.draw",name:"NScreenError",message:"화면 구성 대상영역(레이아웃 영역)이 없습니다.(areaId)"}}}})};return i}());c.RequestParameter=function(j){var i={},h={};i.protocol=location.protocol;i.hostname=location.hostname;i.port=location.port;i.pathname=location.pathname;i.search=(j?(function(o){var m=new Array();var p=((g.get("nsn.paremeter.encoding")?decodeURIComponent(location.search):location.search));if(typeof o==="object"){var l,n;for(l in o){if(o.hasOwnProperty(l)){n=o[l];if(Array.isArray(n)){if(0<n.length){m.push(l+"="+n.join("&"+l+"="))}}else{m.push(l+"="+n)}}}}else{if(typeof o==="string"){m.push(o.split("&").join("&"))}}if(typeof p==="string"&&1<p.length){var k=p.indexOf("?");if(-1<k){m.push(p.substring(k+1).split("&").join("&"))}}return(0<m.length?"?"+m.join("&"):"")}(j)):((g.get("nsn.paremeter.encoding")?decodeURIComponent(location.search):location.search)));i.parameterData=(function(l){var o={};var k,m,n=(3<l.length&&-1<l.indexOf("?")?l.substring(l.indexOf("?")+1):"").split("&");for(var k=0;k<n.length;k+=1){if(n[k]){var m=n[k].split("=");o[m[0]]=o[m[0]]||[];o[m[0]].push(m[1])}}return o}(i.search));i.parameterToSearch=function(){var l=[];var k,m=i.parameterData;for(k in m){if(m.hasOwnProperty(k)){l.push(k+"="+m[k].join("&"+k+"="))}}return(0<l.length?"?"+l.join("&"):"")};h.getProtocol=function(){return i.protocol};h.getHost=function(){return i.hostname+(i.port?":"+i.port:"")};h.getHostname=function(){return i.hostname};h.getPort=function(){return i.port};h.getUri=function(){return i.pathname};h.toParameterQuery=i.parameterToSearch;h.getUrl=function(){return i.protocol+i.hostname+(i.port?":"+i.port:"")+i.pathname+i.parameterToSearch()};h.isParameter=function(k,m){var l=i.parameterData;if(k&&l.hasOwnProperty(k)){return(-1<m&&m<l[k].length)}return false};h.removeParameter=function(k,n){var l=null;var m=i.parameterData;if(k&&m.hasOwnProperty(k)){if(isNaN(n)){m[k]=null}else{l=m[k].splice((-1<n?(n<m[k].length?n:m[k].length-1):0),1)[0]}}return l};h.putParameter=function(l,k){if(l&&Array.isArray(k)&&0<k.length){i.parameterData[l]=k.slice();return k}return null};h.getParameter=function(k,m){var l=i.parameterData;if(k&&l.hasOwnProperty(k)){return l[k].slice(-1<m?(m<l[k].length?m:l[k].length-1):0,1)[0]}return null};h.getParameterNames=function(){var l=[];var k,m=i.parameterData;for(k in m){if(m.hasOwnProperty(k)){l.push(k)}}return l};h.getParameterValues=function(k){var l=[];var m=i.parameterData;if(k&&m.hasOwnProperty(k)){l=m[k].slice()}return l};return h};c.goScreen=function(j,i,h){window.location.href=(h?h:"")+"?"+encodeURIComponent((sui.env.get("nsn.screenId")+"="+j)+(i?("&"+i):""))};c.goHistoryBack=function(h){window.history.back()};c.callScreen=function(m,h,i,l,k){try{m=m||g.get("nsn.default.main");h=h||g.get("nsn.url");i=i||g.get("nsn.kind");l=l||g.get("nsn.method");sui.trn.asyncTran(i,l,(h+m),null,(function(o,p){if("success"===p){if("DataSet"!==o.type){if("string"===typeof(o)){o=JSON.parse(o)}o=new sui.uti.collections.DataSet("",o)}if("E"===o.get("prcSts")){if(k){k(o.get("prcSts"),o.get("resCode"),o)}else{throw {at:"sui.nsn.callScreen",name:"NScreenError",message:"[callScreen] 서버에서 오류가 발생 했습니다."}}}else{b.nScreenDraw.draw(m,"","",o,k)}}else{var n={at:"sui.nsn.callScreen",name:"NScreenError - network is failed",message:"[callScreen] 화면구성을 위해 서버와의 통신이 원활하지 않습니다."};if(e.errorEnabled()){e.error(n)}if(k){k("E","SN91",n)}else{throw n}}}))}catch(j){throw {at:"sui.nsn.callScreen",name:"NScreenError",message:"callScreen 함수 실행결과가 올바르지 않습니다."}}};return c};sui.addModule("sui.nsn",a())})();